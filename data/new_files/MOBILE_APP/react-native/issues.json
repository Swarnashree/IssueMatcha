[{"title":"Android events don't get fired using mEventDispatcher.dispatchEvent with the New Architecture and bridgeless off","body":"### Description\n\nWhile migrating some libraries to be compatible with the new architecture I notice this problem where on Android, events don't get fired when using mEventDispatcher.dispatchEvent with the New Architecture and bridgeless off, but these same events work fine when running using the old arch or with bridgeless on.\r\n\r\n\r\nIt seems that for some reason `this.mFabricEventEmitter` from `ReactEventEmitter` is null when an event is fired \n\n### Steps to reproduce\n\n1. Using a non migrated custom view module, fire an event from the native side using `mEventDispatcher.dispatchEvent()`\r\n2. Observe that the event is not received on the JS side\n\n### React Native Version\n\n0.74.0-rc.4\n\n### Affected Platforms\n\nRuntime - Android\n\n### Areas\n\nFabric - The New Renderer, Bridgeless - The New Initialization Flow\n\n### Output of `npx react-native info`\n\n```text\nSystem:\r\n  OS: macOS 14.0\r\n  CPU: (12) arm64 Apple M2 Max\r\n  Memory: 114.81 MB \/ 32.00 GB\r\n  Shell:\r\n    version: \"5.9\"\r\n    path: \/bin\/zsh\r\nBinaries:\r\n  Node:\r\n    version: 20.11.1\r\n    path: ~\/.volta\/tools\/image\/node\/20.11.1\/bin\/node\r\n  Yarn:\r\n    version: 3.6.4\r\n    path: ~\/.volta\/tools\/image\/yarn\/1.22.22\/bin\/yarn\r\n  npm:\r\n    version: 10.2.4\r\n    path: ~\/.volta\/tools\/image\/node\/20.11.1\/bin\/npm\r\n  Watchman: Not Found\r\nManagers:\r\n  CocoaPods:\r\n    version: 1.14.3\r\n    path: \/Users\/gabriel\/.rbenv\/shims\/pod\r\nSDKs:\r\n  iOS SDK:\r\n    Platforms:\r\n      - DriverKit 23.2\r\n      - iOS 17.2\r\n      - macOS 14.2\r\n      - tvOS 17.2\r\n      - visionOS 1.0\r\n      - watchOS 10.2\r\n  Android SDK:\r\n    API Levels:\r\n      - \"22\"\r\n      - \"26\"\r\n      - \"30\"\r\n      - \"31\"\r\n      - \"33\"\r\n      - \"34\"\r\n    Build Tools:\r\n      - 26.0.3\r\n      - 30.0.3\r\n      - 31.0.0\r\n      - 33.0.0\r\n      - 33.0.1\r\n      - 33.0.2\r\n      - 34.0.0\r\n    System Images:\r\n      - android-22 | ARM 64 v8a\r\n      - android-26 | Google APIs Intel x86_64 Atom\r\n      - android-30 | ARM 64 v8a\r\n      - android-33 | Google APIs ARM 64 v8a\r\n      - android-33 | Google Play ARM 64 v8a\r\n      - android-34 | Google Play ARM 64 v8a\r\n    Android NDK: Not Found\r\nIDEs:\r\n  Android Studio: 2023.2 AI-232.10300.40.2321.11567975\r\n  Xcode:\r\n    version: 15.2\/15C500b\r\n    path: \/usr\/bin\/xcodebuild\r\nLanguages:\r\n  Java:\r\n    version: 17.0.8\r\n    path: \/usr\/bin\/javac\r\n  Ruby:\r\n    version: 2.7.8\r\n    path: \/Users\/gabriel\/.rbenv\/shims\/ruby\r\nnpmPackages:\r\n  \"@react-native-community\/cli\": Not Found\r\n  react:\r\n    installed: 18.2.0\r\n    wanted: 18.2.0\r\n  react-native:\r\n    installed: 0.74.0-rc.4\r\n    wanted: 0.74.0-rc.4\r\n  react-native-macos: Not Found\r\nnpmGlobalPackages:\r\n  \"*react-native*\": Not Found\r\nAndroid:\r\n  hermesEnabled: true\r\n  newArchEnabled: true\r\niOS:\r\n  hermesEnabled: Not found\r\n  newArchEnabled: true\n```\n\n\n### Stacktrace or Logs\n\n```text\nUnhandled SoftException\r\n                                                                                                    com.facebook.react.bridge.ReactNoCrashSoftException: Cannot find EventEmitter for receiveEvent: SurfaceId[1] ReactTag[16] UIManagerType[2] EventName[topChange]\r\n                                                                                                    \tat com.facebook.react.uimanager.events.ReactEventEmitter.receiveEvent(ReactEventEmitter.java:148)\r\n                                                                                                    \tat com.facebook.react.uimanager.events.Event.dispatchModern(Event.java:189)\r\n                                                                                                    \tat com.facebook.react.uimanager.events.EventDispatcherImpl$DispatchEventsRunnable.run(EventDispatcherImpl.java:376)\r\n                                                                                                    \tat android.os.Handler.handleCallback(Handler.java:942)\r\n                                                                                                    \tat android.os.Handler.dispatchMessage(Handler.java:99)\r\n                                                                                                    \tat com.facebook.react.bridge.queue.MessageQueueThreadHandler.dispatchMessage(MessageQueueThreadHandler.java:27)\r\n                                                                                                    \tat android.os.Looper.loopOnce(Looper.java:201)\r\n                                                                                                    \tat android.os.Looper.loop(Looper.java:288)\r\n                                                                                                    \tat com.facebook.react.bridge.queue.MessageQueueThreadImpl$4.run(MessageQueueThreadImpl.java:233)\r\n                                                                                                    \tat java.lang.Thread.run(Thread.java:1012)\n```\n\n\n### Reproducer\n\nhttps:\/\/github.com\/gabrieldonadel\/react-native-android-event-dispatcher-bug\n\n### Screenshots and Videos\n\n <table>\r\n<tr>\r\n<th>old arch<\/th>\r\n<th colspan=\"2\">new arch<\/th>\r\n<\/tr>\r\n<tr>\r\n<th><\/th>\r\n<th>with bridge<\/th>\r\n<th>bridgeless<\/th>\r\n<\/tr>\r\n<tr>\r\n<td><video src=\"https:\/\/github.com\/facebook\/react-native\/assets\/11707729\/bbc99539-a6ff-410f-95a9-2b60562319ef\" \/><\/td>\r\n<td><video src=\"https:\/\/github.com\/facebook\/react-native\/assets\/11707729\/11c0a6af-f957-4351-814b-e9065c62b6fc\" \/><\/td>\r\n<td><video src=\"https:\/\/github.com\/facebook\/react-native\/assets\/11707729\/782bb190-f811-4745-8571-cc800bb0b65f\" \/><\/td>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<\/tr>\r\n<\/table>","comments":[],"labels":["Platform: Android","p: Expo","Partner","Needs: Triage :mag:","Type: New Architecture"],"number":43635},{"title":"Update package.json to fix `ccache_enabled` option, fixes #43633","body":"## Summary:\r\n\r\nI found in 0.74.0-rc.x, `ccache_enabled` is introduced. However, it is not being delivered via npm.\r\n\r\nfixes #43633\r\n\r\nChangelog: [iOS] [Fixed] - Adding ccache_clang wrapper scripts to package.json for distribution","comments":["Hi @CatStudioApp! \n\nThank you for your pull request and welcome to our community. \n\n# Action Required\n\nIn order to merge **any pull request** (code, docs, etc.), we **require** contributors to sign our **Contributor License Agreement**, and we don't seem to have one on file for you.\n\n# Process\n\nIn order for us to review and merge your suggested changes, please sign at <https:\/\/code.facebook.com\/cla>. **If you are contributing on behalf of someone else (eg your employer)**, the individual CLA may not be sufficient and your employer may need to sign the corporate CLA.\n\nOnce the CLA is signed, our tooling will perform checks and validations. Afterwards, the **pull request will be tagged** with `CLA signed`. The tagging process may take up to 1 hour after signing. Please give it that time before contacting us about it.\n\nIf you have received this in error or have any questions, please contact us at [cla@meta.com](mailto:cla@meta.com?subject=CLA%20for%20facebook%2Freact-native%20%2343634). Thanks!","\n<!--\n  0 failure: \n  1 warning:  :clipboard: Missi...\n  \n  \n  DangerID: danger-id-Danger;\n-->\n\n\n<table>\n  <thead>\n    <tr>\n      <th width=\"50\"><\/th>\n      <th width=\"100%\" data-danger-table=\"true\">Warnings<\/th>\n    <\/tr>\n  <\/thead>\n  <tbody><tr>\n      <td>:warning:<\/td>\n      <td>:clipboard: Missing Test Plan - <i>Can you add a Test Plan? To do so, add a \"## Test Plan\" section to your PR description. A Test Plan lets us know how these changes were tested.<\/i><\/td>\n    <\/tr>\n  <\/tbody>\n<\/table>\n\n\n\n<p align=\"right\">\n  Generated by :no_entry_sign: <a href=\"https:\/\/danger.systems\/js\">dangerJS<\/a> against f95d587248ae5bf0b1f3d64e88122d862bb43ca1\n<\/p>\n","CLA signed... not sure why it is not updated","| Platform | Engine | Arch | Size (bytes) | Diff |\n|:---------|:-------|:-----|-------------:|-----:|\n| android | hermes | arm64-v8a | 18,171,335 | -9 |\n| android | hermes | armeabi-v7a | n\/a | -- |\n| android | hermes | x86 | n\/a | -- |\n| android | hermes | x86_64 | n\/a | -- |\n| android | jsc | arm64-v8a | 21,540,479 | +4 |\n| android | jsc | armeabi-v7a | n\/a | -- |\n| android | jsc | x86 | n\/a | -- |\n| android | jsc | x86_64 | n\/a | -- |\n\nBase commit: 4c8e253d83283aa31d0bb97893c3f83e37b46070\nBranch: main","Thank you for signing our Contributor License Agreement. We can now accept your code for this (and any) Meta Open Source project. Thanks!"],"labels":["CLA Signed","Shared with Meta"],"number":43634},{"title":"React Native 0.74.0-rc.4: `use_ccache` is broken: no ccache wrapper script `ccache-clang.sh` bundled in npm package","body":"### Description\n\nif `use_ccache`, it would find wrapper scripts in this path `node_modules\/react-native\/scripts\/xcode\/...` but this directory does not contain that script\r\nhttps:\/\/github.com\/facebook\/react-native\/blob\/main\/packages\/react-native\/scripts\/xcode\/ccache-clang.sh\r\n\r\n<img width=\"300\" alt=\"image\" src=\"https:\/\/github.com\/facebook\/react-native\/assets\/52243759\/dc84136c-e3b5-45f5-b1fb-97d7d675ebc9\">\r\n\n\n### Steps to reproduce\n\nN\/A\n\n### React Native Version\n\n0.74.0-rc.4\n\n### Affected Platforms\n\nRuntime - iOS\n\n### Output of `npx react-native info`\n\n```text\nN\/A\n```\n\n\n### Stacktrace or Logs\n\n```text\nN\/A\n```\n\n\n### Reproducer\n\nN\/A\n\n### Screenshots and Videos\n\n_No response_","comments":["| :warning: | Missing Reproducible Example |\n| --- | --- |\n| :information_source: | We could not detect a reproducible example in your issue report. Please provide either: <br \/><ul><li>If your bug is UI related: a [Snack](https:\/\/snack.expo.dev)<\/li><li> If your bug is build\/update related: use our [Reproducer Template](https:\/\/github.com\/react-native-community\/reproducer-react-native\/generate). A reproducer needs to be in a GitHub repository under your username.<\/li><\/ul> |"],"labels":["Needs: Triage :mag:","Needs: Author Feedback","Needs: Repro","\ud83d\udce6Bundler"],"number":43633},{"title":"[regression] React Native 0.74.0-rc.4: ERROR: [ContentDelivery.Uploader] Asset validation failed (90360) Missing Info.plist value. A value for the key 'MinimumOSVersion' in bundle Foo.app\/Frameworks\/hermes.framework is required","body":"### Description\n\nThe hermes engine bundled in RN 0.74.0-rc.4 is busted.\n\n### Steps to reproduce\n\n1. Create new app using RN 0.74.0\r\n2. Submit for app store\n\n### React Native Version\n\n0.74.0-rc.4\n\n### Affected Platforms\n\nRuntime - iOS\n\n### Output of `npx react-native info`\n\n```text\nSystem:\r\n  OS: macOS 14.4\r\n  CPU: (10) arm64 Apple M1 Max\r\n  Memory: 81.69 MB \/ 64.00 GB\r\n  Shell:\r\n    version: \"5.9\"\r\n    path: \/bin\/zsh\r\nBinaries:\r\n  Node:\r\n    version: 21.7.1\r\n    path: \/opt\/homebrew\/bin\/node\r\n  Yarn:\r\n    version: 1.22.21\r\n    path: \/opt\/homebrew\/bin\/yarn\r\n  npm:\r\n    version: 10.5.0\r\n    path: \/opt\/homebrew\/bin\/npm\r\n  Watchman:\r\n    version: 2024.03.18.00\r\n    path: \/opt\/homebrew\/bin\/watchman\r\nManagers:\r\n  CocoaPods:\r\n    version: 1.15.2\r\n    path: \/Users\/wildcat\/.rbenv\/shims\/pod\r\nSDKs:\r\n  iOS SDK:\r\n    Platforms:\r\n      - DriverKit 23.4\r\n      - iOS 17.4\r\n      - macOS 14.4\r\n      - tvOS 17.4\r\n      - visionOS 1.1\r\n      - watchOS 10.4\r\n  Android SDK:\r\n    API Levels:\r\n      - \"31\"\r\n      - \"33\"\r\n      - \"34\"\r\n    Build Tools:\r\n      - 30.0.3\r\n      - 34.0.0\r\n    System Images:\r\n      - android-34 | Google APIs ARM 64 v8a\r\n    Android NDK: 26.1.10909125\r\nIDEs:\r\n  Android Studio: Not Found\r\n  Xcode:\r\n    version: 15.3\/15E204a\r\n    path: \/usr\/bin\/xcodebuild\r\nLanguages:\r\n  Java:\r\n    version: 17.0.9\r\n    path: \/usr\/bin\/javac\r\n  Ruby:\r\n    version: 3.1.4\r\n    path: \/Users\/wildcat\/.rbenv\/shims\/ruby\r\nnpmPackages:\r\n  \"@react-native-community\/cli\": Not Found\r\n  react:\r\n    installed: 18.2.0\r\n    wanted: ^18.2.0\r\n  react-native:\r\n    installed: 0.74.0-rc.4\r\n    wanted: 0.74.0-rc.4\r\n  react-native-macos: Not Found\r\nnpmGlobalPackages:\r\n  \"*react-native*\": Not Found\r\nAndroid:\r\n  hermesEnabled: Not found\r\n  newArchEnabled: Not found\r\niOS:\r\n  hermesEnabled: true\r\n  newArchEnabled: false\n```\n\n\n### Stacktrace or Logs\n\n```text\nN\/A\n```\n\n\n### Reproducer\n\nN\/A\n\n### Screenshots and Videos\n\n_No response_","comments":["| :warning: | Missing Reproducible Example |\n| --- | --- |\n| :information_source: | We could not detect a reproducible example in your issue report. Please provide either: <br \/><ul><li>If your bug is UI related: a [Snack](https:\/\/snack.expo.dev)<\/li><li> If your bug is build\/update related: use our [Reproducer Template](https:\/\/github.com\/react-native-community\/reproducer-react-native\/generate). A reproducer needs to be in a GitHub repository under your username.<\/li><\/ul> |"],"labels":["Impact: Regression","Needs: Triage :mag:","Needs: Author Feedback","Needs: Repro","\ud83d\udce6Bundler"],"number":43632},{"title":"Update debugger-frontend from a96803a...72fb914","body":"Summary:\nChangelog: [Internal] - Update `react-native\/debugger-frontend` from a96803a...72fb914\n\nResyncs `react-native\/debugger-frontend` from GitHub - see `rn-chrome-devtools-frontend` [changelog](https:\/\/github.com\/facebookexperimental\/rn-chrome-devtools-frontend\/compare\/a96803a5b999d2ddbc62f8b9a12019db00019b17...72fb914269e341fcd4782384f56532d68f6ffd24).\n\nDifferential Revision: D55263007\n\n\n","comments":["This pull request was **exported** from Phabricator. Differential Revision: [D55263007](https:\/\/www.internalfb.com\/diff\/D55263007)","| Platform | Engine | Arch | Size (bytes) | Diff |\n|:---------|:-------|:-----|-------------:|-----:|\n| android | hermes | arm64-v8a | 18,171,495 | +13 |\n| android | hermes | armeabi-v7a | n\/a | -- |\n| android | hermes | x86 | n\/a | -- |\n| android | hermes | x86_64 | n\/a | -- |\n| android | jsc | arm64-v8a | 21,540,599 | +17 |\n| android | jsc | armeabi-v7a | n\/a | -- |\n| android | jsc | x86 | n\/a | -- |\n| android | jsc | x86_64 | n\/a | -- |\n\nBase commit: b13e9f8f7582b451fcdd2b647f49be4bb00eb068\nBranch: main"],"labels":["CLA Signed","p: Facebook","Partner","fb-exported"],"number":43628}]